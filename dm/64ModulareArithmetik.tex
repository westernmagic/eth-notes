\section{Modulare Arithmetik}
\begin{def*}[note = kongruent , index = kongruent]
	\begin{gather*}
		a, b \in \Z , m > 1 \\
		a \equiv n \pmod m :\iff  m | (a-b)
	\end{gather*}
	Äquivalent: $a = b + zm \quad z \in \Z$\\
\end{def*}
Es gilt: $a \equiv b \pmod m \iff R_m(a) = R_m(b)$ \\
\begin{bew}
	\begin{gather*}
		a = q_1 m + R_m(a) \\
		b = q_2 m + R_m(b) \\
		0 \leq R_m(\cdot) < m \\
		\begin{split}
			a \equiv b \pmod m	&\iff m | (a-b) \\
							&\iff m | (\underbrace{R_m(a) - R_m(b)}_{-m< \dots <m}) \\
							&\iff R_m(a) = R_m(b)
		\end{split}
	\end{gather*}
\end{bew}
\begin{gather*}
	a \equiv R_m(a) \pmod m \\
	R_m(a) = R_m(R_m(a))
\end{gather*}
\begin{satz*}
	\begin{gather*}
		R_m(a + b) = R_m(R_m(a) + R_m(b)) \\
		R_m(a \cdot b) = R_m(R_m(a) \cdot R_m(b))
	\end{gather*}
	\begin{bew}
		\[ a + b \equiv_m R_m(a) + R_m(b) \quad \blacksquare \]
	\end{bew}
\end{satz*}
Anwendungen:
\begin{itemize}
	\item Vereinfachen von Rechnungen $R_m(a^x)$
	\item Kontrollieren von Rechnen
	\item Die meisten Zahlen beginnen mit 1, 2 oder 3
\end{itemize}

$\equiv_m$ ist Äquivalenzrelation\\
\begin{bew}
	\begin{gather*}
		a \equiv_m a \quad \checkmark \text{ reflexiv} \\
		a \equiv_m b \iff b \equiv_m a\quad \checkmark \\
		a \equiv_m b \wedge b \equiv_m c \implies a \equiv_m c \\
		m | (a-b) \wedge m | (b-c) \implies m | (a-b) + (b-c) \iff m | (a-c)\quad \checkmark
	\end{gather*}
\end{bew}

Äquivalenzklassen
\begin{gather*}
	\{ [0] , [1] , \dotsc , [m-1] \} \eqqcolon \Z_m \\
	\left. \begin{matrix*}[l]
		[a] + [b] \coloneqq [a+b] \\
		[a] \cdot [b] \coloneqq [a \cdot b]
	\end{matrix*} \right\} \text{ wohldefiniert}\\
	\\
	\Z_5 \\
	\begin{matrix}
		+	&0	&1	&2	&3	&4	\\
		0	&0	&1	&2	&3	&4	\\
		1	&1	&2	&3	&4	&0	\\
		2	&2	&3	&4	&0	&1	\\
		3	&3	&4	&0	&1	&2	\\
		4	&4	&0	&1	&2	&3	
	\end{matrix} \qquad
	\begin{matrix}
		\cdot	&0	&1	&2	&3	&4	\\
		0	&0	&0	&0	&0	&0	\\
		1	&0	&1	&2	&3	&4	\\
		2	&0	&2	&4	&1	&3	\\
		3	&0	&3	&1	&4	&2	\\
		4	&0	&4	&3	&2	&1	
	\end{matrix}\\
	\Z_6 \\
	\begin{matrix}
		+	&0	&1	&2	&3	&4	&5	\\
		0	&0	&1	&2	&3	&4	&5	\\
		1	&1	&2	&3	&4	&5	&1	\\
		2	&2	&3	&4	&5	&0	&2	\\
		3	&3	&4	&5	&0	&1	&3	\\
		4	&4	&5	&0	&1	&2	&4	\\
		5	&5	&0	&1	&2	&3	&4	\\
	\end{matrix} \qquad
	\begin{matrix}
		\cdot	&0	&1	&2	&3	&4	&5	\\
		0	&0	&0	&0	&0	&0	&0	\\
		1	&0	&1	&2	&3	&4	&5	\\
		2	&0	&2	&4	&0	&2	&4	\\
		3	&0	&3	&0	&3	&0	&3	\\
		4	&0	&4	&2	&0	&4	&2	\\
		5	&0	&5	&4	&3	&2	&1	\\
	\end{matrix} \\
\end{gather*}
\begin{tabular}{ r | c | c | c | c }
				&Kommutativ	&Assoziativ	&Neutralelement		&Inverse			\\ \hline
	Addition		&$\checkmark$	&$\checkmark$	&$\checkmark (0)$	&$\checkmark (-a)$	\\
	Multiplikation	&$\checkmark$	&$\checkmark$	&$\checkmark (1)$	&???				
\end{tabular}

\subsubsection{Multiplikative Inverse?}
\begin{gather*}
	a \in \Z_m \\
	[a] \cdot [x] = [1] \\
	a \cdot x \equiv 1 \pmod m \\
	\intertext{Hat}
	\underbrace{a \cdot x}_{d \mid} = \underbrace{1 + l \cdot m}_{d \nmid} \quad ( k \in \Z )
	\intertext{immer eine Lösung?}
\end{gather*}
\uline{Nein}, falls $a = 0$ \\
\uline{Nein}, falls $\ggt(a,m) = d > 1$ \\
\uline{Ja}, falls $\ggt(a,m) = 1$ \\
\begin{gather*}
	\exists u , v : u \cdot a + v \cdot m = 1 \\
	u \cdot a \equiv 1 \pmod m \\
	u \equiv a^{-1} \pmod m
\end{gather*}
Inverse können mit erweitertem Euklid berechnet werden.
\begin{gather*}
	\Z_5^* = \Z_5 \setminus \{ 0 \} = \{ 1 , 2 , 3 , 4 \} \\
	\Z_6^* = \{ 1 , 5 \} \\
	\Z_m^* = \{ a \in \Z_m \mid \ggt(a,m) = 1 \}
\end{gather*}
Ziel: Verständnis von Public-Key Kryptosysteme
$( \Z_m , + )$: Einfache Struktur, alle Elemente haben Inverse. Unbrauchbar für Kryptographie. \\
$( \Z_m^* , \cdot )$: geeignet. \\
Verständnis von $\Z_m^*$:
\begin{itemize}
	\item Chinesische Restsatz
	\item Gruppe
\end{itemize}

\subsubsection{Der chinesischer Restsatz}
\begin{gather*}
	\left. \begin{matrix*}[l]
		x \equiv 2 \pmod 3 \\
		x \equiv 3 \pmod 5
	\end{matrix*} \right\} \iff x \equiv 8 \pmod 15 \\
	\intertext{aber:}
	\left. \begin{matrix*}[l]
		x \equiv 1 \pmod 6 \\
		x \equiv 2 \pmod 8
	\end{matrix*} \right\} \iff \text{ keine Lösung}
\end{gather*}
\begin{satz*}[note = Chinesischer Restsatz (CRS):]
	$m_i , i = 1 , \dotsc , r$, paarweise teilerfremd: \\
	\begin{gather*}
		\ggt(m_i , m_j) = 1 \text{ für } i \neq j \\
		a_i \in \Z \\
		\intertext{Dann ist}
		\left. \begin{matrix*}[l]
			x \equiv a_1 \pmod {m_1} \\
			x \equiv a_2 \pmod {m_2} \\
			\vdots \\
			x \equiv a_r \pmod {m_r}
		\end{matrix*} \right\} *
		\intertext{äquivalent zu einer Kongruenz}
		x \equiv a \pmod M \\
		M = \prod_{i=1}^r m_i
	\end{gather*}
	Mit anderen Worten, $*$ hat genau eine Lösung $a$ in $\{0 , \dotsc , M-1 \}$, und $a$ kann effizient berechnet werden.
	\begin{bew}[head = Beweisidee:]
		\begin{gather*}
			x_1 \equiv  1 \pmod 3 \\
			x_1 \equiv 0 \pmod 5 \\
			x_2 \equiv 0 \pmod 3 \\
			x_2 \equiv 1 \pmod 5 \\
			\text{Dann: } x = 2 x_1 + 3 x_2 \\
			x_1 = \underbrace{5 ( \cdot 5^{-1} \pmod 3 )}_{\substack{\equiv 1 \pmod 3 \\ = -1}} = -5 \\
			x_2 = 3 \cdot ( \underbrace{3^{-1} \pmod 5}_{2} ) = 6
			\intertext{Existenz}
			M = \prod m_i \\
			M_i \coloneqq \frac{M}{m_i} = m_1 m_2 \dotsm m_{i-1} m_{i+1} \dotsm m_r \\
			\text{Dann } \ggt(M_i , m_i) = 1 \quad (m_i \text{ teilerfremd}) \\
			\text{Also gibt es $N_i$ mit} \\
			M_i N_i \equiv 1 \pmod m_1 \quad ( N_i \equiv M_i^{-1} \pmod {m_i} ) \\
			M_i N_i \equiv 0 \pmod {m_j} \quad j \neq i \\
			\text{Lösung: } R_M \left( \sum_{i=1}^r a_i M_i N_i \right) \\
			a_1 M_1 N_1 + \dots + a_r M_r N_r \equiv a_1 \pmod {m_1} \\
			\intertext{Eindeutigkeit}
			\text{Lösungen } x , x' \in * \\
			m_i \mid (x - x') \\
			\implies \prod m_i \mid (x - x') \implies x \equiv x' \pmod M \quad \blacksquare
		\end{gather*}
	\end{bew}
\end{satz*}
\todo{Too long}
Konsequenz: Spezialfall $m = p q ; p , q$ prim, $p \neq q$ \\
\begin{gather*}
	\left. \begin{matrix*}[l]
		x \equiv a_1 \pmod p \\
		x \equiv a_2 \pmod q
	\end{matrix*} \right\} \iff x \equiv a \pmod {p q} \\
	\Z_m = \Z_p \times \Z_q \\
	a \in \Z_m \leftrightarrow \begin{pmatrix} a_1 \\ a_2 \end{pmatrix} \begin{matrix} \in \Z_p \\ \in \Z_q \end{matrix} \\
	\begin{split}
		\enquote{\rightarrow} :	&a_1 = R_p(a) \equiv a \\
					&a_2 = R_q(a) \equiv a
	\end{split} \\
	\enquote{\leftarrow} : \text{ CRS} \\
	a = R_m( a_1 \underbrace{M_1 N_1}_{q \cdot q^{-1} \pmod p} + a_2 \underbrace{M_2 N_2}_{p \cdot p^{-1} \pmod q} )
\end{gather*}

Verträglichkeit der Operationen:
\begin{gather*}
	a \leftrightarrow \begin{pmatrix} a_1 \\ a_2 \end{pmatrix} \\
	b \leftrightarrow \begin{pmatrix} b_1 \\ b_2 \end{pmatrix} \\
	a + b \leftrightarrow \begin{pmatrix} a_1 + b_1 \\ a_2 + b_2 \end{pmatrix} \\
	a \cdot b \leftrightarrow \begin{pmatrix} a_1 \cdot b_1 \\ a_2 \cdot b_2 \end{pmatrix}
\end{gather*}
\begin{bsp*}
	\begin{gather*}
		\Z_{15} = \Z_5 \times \Z_3 \\
		8 \leftrightarrow \begin{pmatrix} 3 \\ 2 \end{pmatrix} \\
		2 \leftrightarrow \begin{pmatrix} 2 \\ 2 \end{pmatrix} \\
		\underbrace{8 + 2}_{=10} \leftrightarrow \begin{pmatrix} 0 \\ 1 \end{pmatrix} \\
		\underbrace{8 \cdot 2}_{\substack{=16 \\ \equiv \pmod {15}}} \leftrightarrow \begin{pmatrix} 1 \\ 1 \end{pmatrix}
	\end{gather*}
\end{bsp*}
\begin{gather*}
	\Z_{15} = \Z_5 \times \Z_3 \\
	\begin{split}
		\Z_{15}^*	&= \{ 1 , 2 , 4 , 7 , 8 , 11 , 13 , 14 \} \\
				&= \left\{
					\begin{pmatrix}1\\1\end{pmatrix} ,
					\begin{pmatrix}2\\2\end{pmatrix} ,
					\begin{pmatrix}4\\1\end{pmatrix} ,
					\begin{pmatrix}2\\1\end{pmatrix} ,
					\begin{pmatrix}3\\2\end{pmatrix} ,
					\begin{pmatrix}1\\2\end{pmatrix} ,
					\begin{pmatrix}3\\1\end{pmatrix} ,
					\begin{pmatrix}4\\2\end{pmatrix} \right\} \\
				&= \{ 1 , 2 , 3 , 4 \} \times \{ 1 , 2 \} \\
				&= \Z_5^* \times \Z_3^*
	\end{split} \\
	\begin{split}
	a \in \Z_m^*	&\iff \ggt( a , p q ) = 1 \\
				&\iff \ggt(a,p) = 1 \wedge \ggt(a,q) = 1 \\
				&\iff \ggt(a_1,p) = 1 \wedge \ggt(a_2,q) \\
				&\iff a_1 \in \Z_p^* \wedge a_2 \in \Z_q^*
	\end{split}
	\intertext{Allgemein:}
	\Z_m^* = \Z_p^* \times \Z_q^* \\
	\abs{\Z_m^*} = \abs{\Z_p^*} \cdot \abs{\Z_q^*} = (p-1)(q-1)
	\intertext{Beliebige Moduli:}
	m = \prod^r \underbrace{p_i^{e_i}}_{m_i} \\
	\text{CRS: } \Z_m^* = \Z_{p_1^{e_1}}^* \times \Z_{p_2^{e_2}}^* \times \dots \times \Z_{p_r^{e_r}}^* \\
	\abs{\Z_m^*} = \underbrace{\abs{\Z_{p_1^{e_1}}^*}}_{\substack{(p_1 - 1) p_1^{e_1 - 1}\\=(1-\frac{1}{p_1})p_1^{e_1}}} \cdot \abs{\Z_{p_2^{e_2}}^*} \dotsm \abs{\Z_{p_r^{e_r}}^*} = \prod_{i=1}^r (p_i - 1) p_i^{e_i - 1} = \varphi(m) \quad \text{Eulerfunktion} \\
\end{gather*}